import type { A3ReportInput } from './types.ts';

export function buildValidateInputPrompt(text: string, fieldType: keyof A3ReportInput): string {
  const fieldValidation: Record<keyof A3ReportInput, string> = {
    what: `Проверь, подходит ли ответ для поля "Что (What)" по методике 5W1H.

Поле "Что" должно описывать СУТЬ ПРОБЛЕМЫ - что именно не работает.

БЛОКИРОВАТЬ НУЖНО только если:
- Совсем нет описания проблемы, только последствия
- ТОЛЬКО цифры и проценты без описания проблемы
- Описывает место или людей, но НЕ описывает саму проблему

Небольшие упоминания других аспектов - это нормально, главное чтобы СУТЬ ПРОБЛЕМЫ была.

Текст: "${text}"

Верни JSON:
{
  "isValid": true или false,
  "message": "Краткое объяснение проблемы" (только если false)
}`,

    where: `Проверь, подходит ли ответ для поля "Где (Where)" по методике 5W1H.

Поле "Где" должно указывать МЕСТО или ПРОЦЕСС.

БЛОКИРОВАТЬ НУЖНО только если:
- Совсем нет упоминания места, подразделения или процесса
- Только описание проблемы без указания где

Если есть хотя бы намек на место/процесс - это подходит.

Текст: "${text}"

Верни JSON:
{
  "isValid": true или false,
  "message": "Краткое объяснение проблемы" (только если false)
}`,

    when: `Проверь, подходит ли ответ для поля "Когда (When)" по методике 5W1H.

Пле "Когда" должно описывать ЭТАП ПРОЦЕССА.

БЛОКИРОВАТЬ НУЖНО только если:
- Совсем нет упоминания этапа, стадии или операции
- Только описание проблемы без указания этапа

Если есть хотя бы намек на этап процесса - это подходит.

Текст: "${text}"

Верни JSON:
{
  "isValid": true или false,
  "message": "Краткое объяснение проблемы" (только если false)
}`,

    who: `Проверь, подходит ли ответ для поля "Кто (Who)" по методике 5W1H.

Поле "Кто" должно указывать ЛЮДЕЙ, РОЛИ или ПОДРАЗДЕЛЕНИЯ.

БЛОКИРОВАТЬ НУЖНО только если:
- Совсем нет упоминания людей, ролей или подразделений
- Только описание проблемы без указания кто

Если есть хотя бы упоминание людей/ролей - это подходит.

Текст: "${text}"

Верни JSON:
{
  "isValid": true или false,
  "message": "Краткое объяснение проблемы" (только если false)
}`,

    why: `Проверь, подходит ли ответ для поля "Почему (Why)" по методике 5W1H.

Поле "Почему" должно объяснять КРИТИЧНОСТЬ и ПОСЛЕДСТВИЯ.

БЛОКИРОВАТЬ НУЖНО только если:
- Совсем нет объяснения почему это важно
- Только описание проблемы без объяснения критичности
- Только технические детали без влияния на бизнес

Если есть хотя бы намек на последствия/критичность - это подходит.

Текст: "${text}"

Верни JSON:
{
  "isValid": true или false,
  "message": "Краткое объяснение проблемы" (только если false)
}`,

    how: `Проверь, подходит ли ответ для поля "Как (How)" по методике 5W1H.

Поле "Как" должно содержать КОНКРЕТНЫЕ ЦИФРЫ и ФАКТЫ.

БЛОКИРОВАТЬ НУЖНО только если:
- Совсем нет никаких цифр, метрик или фактов
- Только общие слова типа "много", "часто" без конкретики
- Только описание последствий без фактических данных

Если есть хотя бы какие-то цифры или попытка количественно описать - это подходит.

Текст: "${text}"

Верни JSON:
{
  "isValid": true или false,
  "message": "Краткое объяснение проблемы" (только если false)
}`
  };

  return fieldValidation[fieldType];
}
